"use strict";(globalThis.webpackChunk_projax_docsite=globalThis.webpackChunk_projax_docsite||[]).push([[6124],{3572:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>l});var i=t(1855);const s={},r=i.createContext(s);function o(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}},9162:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>a});var i=t(3159),s=t(3572);const r={},o="Port Management",l={id:"api/port-management",title:"Port Management",description:"The API server automatically manages port allocation and discovery.",source:"@site/docs/api/port-management.md",sourceDirName:"api",slug:"/api/port-management",permalink:"/docs/api/port-management",draft:!1,unlisted:!1,editUrl:"https://github.com/josetwentyfour/projax/tree/main/packages/docsite/docs/api/port-management.md",tags:[],version:"current",frontMatter:{},sidebar:"api",previous:{title:"Database",permalink:"/docs/api/database"},next:{title:"Error Handling",permalink:"/docs/api/error-handling"}},c={},a=[{value:"Port Discovery",id:"port-discovery",level:2},{value:"Port Selection Process",id:"port-selection-process",level:3},{value:"Port File",id:"port-file",level:3},{value:"Port Range",id:"port-range",level:2},{value:"Port Discovery Methods",id:"port-discovery-methods",level:2},{value:"CLI Discovery",id:"cli-discovery",level:3},{value:"Desktop App Discovery",id:"desktop-app-discovery",level:3},{value:"Health Check",id:"health-check",level:2},{value:"Port Conflicts",id:"port-conflicts",level:2},{value:"Resolving Port Conflicts",id:"resolving-port-conflicts",level:3},{value:"Multiple Instances",id:"multiple-instances",level:2},{value:"Related Documentation",id:"related-documentation",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"port-management",children:"Port Management"}),"\n",(0,i.jsx)(n.p,{children:"The API server automatically manages port allocation and discovery."}),"\n",(0,i.jsx)(n.h2,{id:"port-discovery",children:"Port Discovery"}),"\n",(0,i.jsx)(n.p,{children:"The API server automatically finds an available port in the range 38124-38133."}),"\n",(0,i.jsx)(n.h3,{id:"port-selection-process",children:"Port Selection Process"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Starts checking from port 3001"}),"\n",(0,i.jsx)(n.li,{children:"Tests each port sequentially"}),"\n",(0,i.jsx)(n.li,{children:"Selects the first available port"}),"\n",(0,i.jsx)(n.li,{children:"If no port is available, throws an error"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"port-file",children:"Port File"}),"\n",(0,i.jsxs)(n.p,{children:["The selected port is written to ",(0,i.jsx)(n.code,{children:"~/.projax/api-port.txt"})," for discovery by other components:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Read the port\ncat ~/.projax/api-port.txt\n# Output: 3001\n"})}),"\n",(0,i.jsx)(n.h2,{id:"port-range",children:"Port Range"}),"\n",(0,i.jsxs)(n.p,{children:["Default port range: ",(0,i.jsx)(n.strong,{children:"38124-38133"})]}),"\n",(0,i.jsx)(n.p,{children:"This range is chosen to:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Avoid conflicts with common development ports (3000, 8080, etc.)"}),"\n",(0,i.jsx)(n.li,{children:"Provide multiple instances if needed"}),"\n",(0,i.jsx)(n.li,{children:"Stay within common development port ranges"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"port-discovery-methods",children:"Port Discovery Methods"}),"\n",(0,i.jsx)(n.h3,{id:"cli-discovery",children:"CLI Discovery"}),"\n",(0,i.jsx)(n.p,{children:"The CLI discovers the API port by:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Reading ",(0,i.jsx)(n.code,{children:"~/.projax/api-port.txt"})]}),"\n",(0,i.jsx)(n.li,{children:"If not found, trying common ports (3001-3005)"}),"\n",(0,i.jsx)(n.li,{children:"Checking health endpoint on each port"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"desktop-app-discovery",children:"Desktop App Discovery"}),"\n",(0,i.jsx)(n.p,{children:"The Desktop app uses the same discovery method as the CLI."}),"\n",(0,i.jsx)(n.h2,{id:"health-check",children:"Health Check"}),"\n",(0,i.jsx)(n.p,{children:"Verify the API is running on a specific port:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl http://localhost:38124/health\n"})}),"\n",(0,i.jsx)(n.p,{children:"Expected response:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "status": "ok",\n  "timestamp": "2024-01-01T12:00:00.000Z"\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"port-conflicts",children:"Port Conflicts"}),"\n",(0,i.jsx)(n.p,{children:"If a port is already in use:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The API tries the next port in sequence"}),"\n",(0,i.jsx)(n.li,{children:"If all ports are in use, startup fails with an error"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"resolving-port-conflicts",children:"Resolving Port Conflicts"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Find what's using the port:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# macOS/Linux\nlsof -i :38124\n\n# Windows\nnetstat -ano | findstr :38124\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Kill the process"})," (if safe to do so)"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Restart the API server"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"multiple-instances",children:"Multiple Instances"}),"\n",(0,i.jsx)(n.p,{children:"While not recommended, you can run multiple API instances:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Each instance will find its own available port"}),"\n",(0,i.jsx)(n.li,{children:"Each writes to a different port file (if configured)"}),"\n",(0,i.jsx)(n.li,{children:"CLI/Desktop connect to the first available instance"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/docs/api/installation",children:"Installation"})," - Set up the API server"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/docs/api/integration",children:"Integration"})," - Integrate with the API"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);